package cc.omusic.musicidentify;

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;

import android.os.Environment;


public class SDRecord {

	
	
	
	//private String SDPath = Environment.getExternalStorageDirectory() +"/OmusicRecordVoice/";
	
	
	public  String  checkSD(  ){
		boolean sdExit;
		String SDPath = null;
		//check sd card is  insert?
		sdExit = Environment.getExternalStorageState().equals(
					android.os.Environment.MEDIA_MOUNTED );
		if( sdExit )
			//SDPath = Environment.getExternalStorageDirectory() +"/OmusicRecordVoice/";
			SDPath = Environment.getExternalStorageDirectory()+"";
		return SDPath;
	}
	
	
	
	//create directory in SD card
	 public File createSDDir( String SDPath, String DirName){
		 File dir = new File( SDPath + DirName);
		 if(!dir.exists()){
			 try{
				 // mkdirs() 表示，如果需要，会先创建上层目录.
				 dir.mkdirs();
			 }
			 catch(Exception e){
				 e.printStackTrace();
			 }
		 }
		 
		 return dir;
	 }
	 
	 //create files in SD card
	 public File createSDFile(String  FilePath) throws IOException{
		 File file = new File( FilePath );
		 if(!file.exists()){
			 try{
				 file.createNewFile();
			 }
			 catch(Exception e){
				 e.printStackTrace();
			 }
		 }
		
		 return file;
	 }
	 
	 public File WriteToSDCard( String SDPath,String Path, String FileName, InputStream data){
		 File file = null;
		 OutputStream output = null;
		 try{
			 createSDDir(SDPath,Path);
			 file = createSDFile( Path + FileName);
			 output = new FileOutputStream( file);
			 
			 byte buffer[]= new byte[4*1024];
			 while((data.read(buffer) != -1)){
				 output.write(buffer);
			 }
			 output.flush(); 
		 }
		 catch(Exception e){
			 e.printStackTrace();
		 }
		 finally{
			 try{
				 output.close();
			 }
			 catch(Exception e){
				 e.printStackTrace();
			 }
		 }
		return file;
	 }

}
